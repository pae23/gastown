{"author":"gastown/crew/jack","created_at":"2026-01-14T02:15:49Z","id":1,"issue_id":"gt-f6mkz","text":"## Refinements from discussion\n\n### gt commit wrapper (not hooks)\n\nA `gt commit` wrapper command is cleaner than git hooks:\n- Single implementation point\n- No per-repo hook installation\n- Easy to evolve (validation, conventions)\n- Agents already live in gt namespace\n- All roles that commit use it\n\n### Configurable email domain\n\nTown-level config for custom domains:\n\n```yaml\n# ~/.town/config.yaml\nagent_email_domain: acme.com  # default: gastown.local\n```\n\nPattern: `{name}@{role}.{rig}.{domain}`\n\nExamples:\n- Default: `jack@crew.gastown.gastown.local`\n- Custom:  `jack@crew.gastown.acme.com`\n\nBenefits:\n- Companies get branded attribution\n- Avoids .local TLD quirks\n- Aligns with federation (hop://acme.com matches *@acme.com)"}
{"author":"beads/crew/emma","created_at":"2026-01-19T19:37:45Z","id":3,"issue_id":"gt-gow8b","text":"## Current Implementation (2026-01-19)\n\nWhat exists:\n- gt tap guard pr-workflow - blocks PRs and feature branches\n- Hook configs in 4 settings files: beads/{crew,polecats}, gastown/{crew,polecats}\n- Missing from: rig roots, witness, refinery, deacon (7 files)\n\nThe guard works by:\n1. Detecting Gas Town context (env vars or /crew/, /polecats/ in path)\n2. Exiting 2 to BLOCK when in agent context\n3. Allowing operation for humans outside Gas Town\n\nJoe's shell script hook (not yet integrated):\n- Need to find and document what it does\n- Decide if it should become gt tap command or stay as script"}
{"author":"gastown/crew/max","created_at":"2026-01-19T22:59:10Z","id":6,"issue_id":"gt-y1uvb","text":"Phase 1 complete: Config-based role system implemented.\n\n**New files:**\n- `internal/config/roles.go` - RoleDefinition types, LoadRoleDefinition() with layered override resolution (builtin → town → rig)\n- `internal/config/roles/*.toml` - 7 embedded role definitions (mayor, deacon, dog, witness, refinery, polecat, crew)\n- `internal/config/roles_test.go` - Unit tests for loading, expansion, duration parsing\n\n**New command:**\n- `gt role def \u003crole\u003e` - Displays effective role configuration\n\n**Design decisions:**\n- Used TOML (not YAML) to match existing config patterns\n- Added ToLegacyRoleConfig() for backward compat with existing daemon code\n- Duration type with UnmarshalText for clean TOML parsing\n\nReady for Phase 2: Switch daemon to use LoadRoleDefinition() instead of role beads."}
{"author":"gastown/crew/max","created_at":"2026-01-19T23:16:46Z","id":7,"issue_id":"gt-y1uvb","text":"Phase 2 complete: Daemon now uses config-based roles.\n\n**Changes:**\n- `getRoleConfigForIdentity()` now uses `config.LoadRoleDefinition()` instead of reading role beads\n- Layered override resolution: builtin → town → rig\n- Backward compatible: returns `beads.RoleConfig` format for existing daemon code\n- Updated integration tests to test config-based behavior instead of role bead behavior\n\nAll daemon and config tests pass. Ready for Phase 3: Clean up role beads."}
{"author":"gastown/crew/max","created_at":"2026-01-19T23:37:27Z","id":8,"issue_id":"gt-y1uvb","text":"Phase 3 complete: Role beads cleanup.\n\n**Changes:**\n- Removed role bead creation from `gt install` - roles are now config-based\n- Removed `gt migrate-agents` command (no longer needed)\n- Updated `gt doctor` role check to validate config files instead of role beads\n- Removed `RoleBead` field from `AgentFields` struct\n- Marked `beads_role.go` as deprecated\n\nAll builds pass. Phase 4 (documentation) is optional."}
